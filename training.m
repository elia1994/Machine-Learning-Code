function W=training(N1)
N2=2*N1;
N3=N1*N1*2;
N4=N3*2;
W=zeros(7,N3*3);
x(1,:,:,:)=LoadImage('stop1.png');
x(2,:,:,:)=LoadImage('stop2.png');
x(3,:,:,:)=LoadImage('stop3.png');
x(4,:,:,:)=LoadImage('stop4.png');
x(5,:,:,:)=LoadImage('stop5.png');
x(6,:,:,:)=LoadImage('stop6.png');
x(7,:,:,:)=LoadImage('divieto1.png');
x(8,:,:,:)=LoadImage('divieto2.png');
x(9,:,:,:)=LoadImage('divieto3.png');
x(10,:,:,:)=LoadImage('divieto4.png');
x(11,:,:,:)=LoadImage('divieto5.png');
x(12,:,:,:)=LoadImage('divieto6.png');
x(13,:,:,:)=LoadImage('stopconsfondo1.png');
x(14,:,:,:)=LoadImage('stopconsfondo2.png');
x(15,:,:,:)=LoadImage('stop7.png');
x(16,:,:,:)=LoadImage('stop8.png');
x(17,:,:,:)=LoadImage('stop9.png');
x(18,:,:,:)=LoadImage('stop10.png');
x(19,:,:,:)=LoadImage('divieto7.png');
x(20,:,:,:)=LoadImage('divieto8.png');
x(21,:,:,:)=LoadImage('divieto9.png');
x(22,:,:,:)=LoadImage('divieto10.png');
x(23,:,:,:)=LoadImage('divietoconsfondo1.png');
x(24,:,:,:)=LoadImage('divietoconsfondo2.png');
x(25,:,:,:)=LoadImage('transito1.png');
x(26,:,:,:)=LoadImage('transito2.png');
x(27,:,:,:)=LoadImage('transito3.png');
x(28,:,:,:)=LoadImage('transito4.png');
x(29,:,:,:)=LoadImage('transito5.png');
x(30,:,:,:)=LoadImage('transito6.png');
x(31,:,:,:)=LoadImage('veloc1.png');
x(32,:,:,:)=LoadImage('veloc2.png');
x(33,:,:,:)=LoadImage('veloc3.png');
x(34,:,:,:)=LoadImage('veloc4.png');
x(35,:,:,:)=LoadImage('veloc5.png');
x(36,:,:,:)=LoadImage('veloc6.png');
x(37,:,:,:)=LoadImage('transitosfondo1.png');
x(38,:,:,:)=LoadImage('transitosfondo2.png');
x(39,:,:,:)=LoadImage('transito7.png');
x(40,:,:,:)=LoadImage('transito8.png');
x(41,:,:,:)=LoadImage('transito9.png');
x(42,:,:,:)=LoadImage('transito10.png');
x(43,:,:,:)=LoadImage('veloc7.png');
x(44,:,:,:)=LoadImage('veloc8.png');
x(45,:,:,:)=LoadImage('veloc9.png');
x(46,:,:,:)=LoadImage('veloc10.png');
x(47,:,:,:)=LoadImage('velocsfondo1.png');
x(48,:,:,:)=LoadImage('velocsfondo2.png');
x(49,:,:,:)=LoadImage('closed1.png');
x(50,:,:,:)=LoadImage('closed2.png');
x(51,:,:,:)=LoadImage('closed3.png');
x(52,:,:,:)=LoadImage('closed4.png');
x(53,:,:,:)=LoadImage('closed5.png');
x(54,:,:,:)=LoadImage('closed6.png');
x(55,:,:,:)=LoadImage('closed7.png');
x(56,:,:,:)=LoadImage('closed8.png');
x(57,:,:,:)=LoadImage('closed9.png');
x(58,:,:,:)=LoadImage('closed10.png');
x(59,:,:,:)=LoadImage('closedsfondo1.png');
x(60,:,:,:)=LoadImage('closedsfondo2.png');
x(61,:,:,:)=LoadImage('closedsfondo3.png');
x(62,:,:,:)=LoadImage('closedsfondo4.png');
x(63,:,:,:)=LoadImage('closedsfondo5.png');
x(64,:,:,:)=LoadImage('closedsfondo6.png');
x(65,:,:,:)=LoadImage('confine1.png');
x(66,:,:,:)=LoadImage('confine2.png');
x(67,:,:,:)=LoadImage('confine3.png');
x(68,:,:,:)=LoadImage('confine4.png');
x(69,:,:,:)=LoadImage('confine5.png');
x(70,:,:,:)=LoadImage('confine6.png');
x(71,:,:,:)=LoadImage('confine7.png');
x(72,:,:,:)=LoadImage('confine8.png');
x(73,:,:,:)=LoadImage('confine9.png');
x(74,:,:,:)=LoadImage('confine10.png');
x(75,:,:,:)=LoadImage('confine11.png');
x(76,:,:,:)=LoadImage('confine12.png');
x(77,:,:,:)=LoadImage('confinesfondo1.png');
x(78,:,:,:)=LoadImage('confinesfondo2.png');
x(79,:,:,:)=LoadImage('confinesfondo3.png');
x(80,:,:,:)=LoadImage('confinesfondo4.png');
x(81,:,:,:)=LoadImage('confinesfondo5.png');
x(82,:,:,:)=LoadImage('confinesfondo6.png');
x(83,:,:,:)=LoadImage('park1.png');
x(84,:,:,:)=LoadImage('park2.png');
x(85,:,:,:)=LoadImage('park3.png');
x(86,:,:,:)=LoadImage('park4.png');
x(87,:,:,:)=LoadImage('park5.png');
x(88,:,:,:)=LoadImage('park6.png');
x(89,:,:,:)=LoadImage('park7.png');
x(90,:,:,:)=LoadImage('park8.png');
x(91,:,:,:)=LoadImage('park9.png');
x(92,:,:,:)=LoadImage('park10.png');
x(93,:,:,:)=LoadImage('parksfondo1.png');
x(94,:,:,:)=LoadImage('parksfondo2.png');
x(95,:,:,:)=LoadImage('parksfondo3.png');
x(96,:,:,:)=LoadImage('parksfondo4.png');
x(97,:,:,:)=LoadImage('parksfondo5.png');
x(98,:,:,:)=LoadImage('parksfondo6.png');
x(99,:,:,:)=LoadImage('pedone1.png');
x(100,:,:,:)=LoadImage('pedone2.png');
x(101,:,:,:)=LoadImage('pedone3.png');
x(102,:,:,:)=LoadImage('pedone4.png');
x(103,:,:,:)=LoadImage('pedone5.png');
x(104,:,:,:)=LoadImage('pedone6.png');
x(105,:,:,:)=LoadImage('pedone7.png');
x(106,:,:,:)=LoadImage('pedone8.png');
x(107,:,:,:)=LoadImage('pedone9.png');
x(108,:,:,:)=LoadImage('pedone10.png');
x(109,:,:,:)=LoadImage('pedonesfondo1.png');
x(110,:,:,:)=LoadImage('pedonesfondo2.png');
x(111,:,:,:)=LoadImage('pedonesfondo3.png');
x(112,:,:,:)=LoadImage('pedonesfondo4.png');
x(113,:,:,:)=LoadImage('pedonesfondo5.png');
x(114,:,:,:)=LoadImage('pedonesfondo6.png');

N=114;
y2=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]';
X2=zeros(N,N3*3);
for n=1:N
    r(:,:)=x(n,:,:,1);
    g(:,:)=x(n,:,:,2);
    b(:,:)=x(n,:,:,3);
    Rblocks= splitImm(r,N1);
    Gblocks= splitImm(g,N1);
    Bblocks= splitImm(b,N1);
    RResult = dctBlocks(Rblocks);
    GResult = dctBlocks(Gblocks);
    BResult = dctBlocks(Bblocks);
    REig=eigMatrix(RResult);
    GEig=eigMatrix(GResult);
    BEig=eigMatrix(BResult);
    for i=0:N1-1
        for j=0:N1-1
            for k=1:2
                X2(n,k+i*N2+j*2)=real(REig(i+1,j+1,k+1));
                X2(n,k+i*N2+j*2+N3)=real(GEig(i+1,j+1,k+1));
                X2(n,k+i*N2+j*2+N4)=real(BEig(i+1,j+1,k+1));
            end
        end
    end
end
W(4,:)=X2'*((X2*X2'+0.01*eye(N))\y2);

N=24;
y=[1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1]';
X=zeros(N,N3*3);
X(:,:)=X2(1:24,:);
W(1,:)=X'*((X*X'+0.01*eye(N))\y);

X(:,:)=X2(25:48,:);
W(2,:)=X'*((X*X'+0.01*eye(N))\y);

N=48;
y1=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]';
X1=zeros(N,N3*3);
X1(:,:)=X2(1:48,:);
W(3,:)=X1'*((X1*X1'+0.01*eye(N))\y1);

N=66;
y3=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]';
X3=zeros(N,N3*3);
X3(:,:)=X2(49:114,:);
W(5,:)=X3'*((X3*X3'+0.01*eye(N))\y3);

N=34;
y4=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]';
X4=zeros(N,N3*3);
X4(:,:)=X2(49:82,:);
W(6,:)=X4'*((X4*X4'+0.01*eye(N))\y4);

N=32;
y5=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]';
X5=zeros(N,N3*3);
X5(:,:)=X2(83:114,:);
W(7,:)=X5'*((X5*X5'+0.01*eye(N))\y5);
